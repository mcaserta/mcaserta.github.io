<!doctype html><html lang=en><head><meta charset=UTF-8><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content="Mirko Caserta "><meta name=description content="You need to backup an entire hard disk to a single file. Supposing your disk is at /dev/hda and the backup file is image-file, youâ€™d do:
# cat /dev/hda &amp;gt; image-file or
# dd if=/dev/hda of=image-file The file backup you get will hold a copy of every single bit from the hard disk. This means that you also have a copy of the MBR in the first 512 bytes of the file."><meta name=keywords content=",linux,unix,sysadm"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=/posts/2009/04/how-to-extract-a-filesystem-from-a-disk-image/><title>ðŸ‡ºðŸ‡¸ How to extract a filesystem from a disk image :: â€” Senior Developer
</title><link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css rel=stylesheet type=text/css><link rel=stylesheet href=/main.4e5c639214707eff609bb55fe49e183dee42258a73bc90e4cc7b0a84f900798a.css><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color><link rel="shortcut icon" href=/favicon.ico><meta name=msapplication-TileColor content><meta itemprop=name content="ðŸ‡ºðŸ‡¸ How to extract a filesystem from a disk image"><meta itemprop=description content="You need to backup an entire hard disk to a single file. Supposing your disk is at /dev/hda and the backup file is image-file, youâ€™d do:
# cat /dev/hda > image-file or
# dd if=/dev/hda of=image-file The file backup you get will hold a copy of every single bit from the hard disk. This means that you also have a copy of the MBR in the first 512 bytes of the file."><meta itemprop=datePublished content="2009-04-18T17:10:00+00:00"><meta itemprop=dateModified content="2009-04-18T17:10:00+00:00"><meta itemprop=wordCount content="230"><meta itemprop=image content><meta itemprop=keywords content="linux,unix,sysadm,"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content><meta name=twitter:title content="ðŸ‡ºðŸ‡¸ How to extract a filesystem from a disk image"><meta name=twitter:description content="You need to backup an entire hard disk to a single file. Supposing your disk is at /dev/hda and the backup file is image-file, youâ€™d do:
# cat /dev/hda > image-file or
# dd if=/dev/hda of=image-file The file backup you get will hold a copy of every single bit from the hard disk. This means that you also have a copy of the MBR in the first 512 bytes of the file."><meta property="article:section" content="system administration"><meta property="article:published_time" content="2009-04-18 17:10:00 +0000 UTC"></head><body><div class=container><header class=header><span class=header__inner><a href=/ style=text-decoration:none><div class=logo><span class=logo__mark>$</span>
<span class=logo__text>cd ~mcaserta</span>
<span class=logo__cursor style=background-color:#38af40></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=/about/>About</a></li><li><a href=/cv/>CV</a></li><li><a href=/posts/>Posts</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info></p></div><article><h2 class=post-title><a href=/posts/2009/04/how-to-extract-a-filesystem-from-a-disk-image/>ðŸ‡ºðŸ‡¸ How to extract a filesystem from a disk image</a></h2><hr><aside id=toc><div class=toc-title>Table of Contents</div><nav id=TableOfContents></nav></aside><hr><div class=post-content><p>You need to backup an entire hard disk to a single file. Supposing your disk is
at <code>/dev/hda</code> and the backup file is <code>image-file</code>, youâ€™d do:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># cat /dev/hda &gt; image-file</span>
</span></span></code></pre></div><p>or</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># dd if=/dev/hda of=image-file</span>
</span></span></code></pre></div><p>The file backup you get will hold a copy of every single bit from the hard disk.
This means that you also have a copy of the MBR in the first 512 bytes of the
file.</p><p>Because of this, you can see the partition table on the backup file:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># sfdisk -l -uS image-file</span>
</span></span><span style=display:flex><span>Disk image-file: <span style=color:#ae81ff>0</span> cylinders, <span style=color:#ae81ff>0</span> heads, <span style=color:#ae81ff>0</span> sectors/track
</span></span><span style=display:flex><span>Warning: The partition table looks like it was made
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> C/H/S<span style=color:#f92672>=</span>*/255/32 <span style=color:#f92672>(</span>instead of 0/0/0<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>For this listing I<span style=color:#960050;background-color:#1e0010>&#39;</span>ll assume that geometry.
</span></span><span style=display:flex><span>Units <span style=color:#f92672>=</span> sectors of <span style=color:#ae81ff>512</span> bytes, counting from <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>Device Boot Start End <span style=color:#75715e>#sectors Id System</span>
</span></span><span style=display:flex><span>image-filep1 <span style=color:#ae81ff>32</span> <span style=color:#ae81ff>261119</span> <span style=color:#ae81ff>261088</span> <span style=color:#ae81ff>83</span> Linux
</span></span><span style=display:flex><span>image-filep2 <span style=color:#ae81ff>261120</span> <span style=color:#ae81ff>4267679</span> <span style=color:#ae81ff>4006560</span> <span style=color:#ae81ff>82</span> Linux swap / Solaris
</span></span><span style=display:flex><span>image-filep3 <span style=color:#ae81ff>4267680</span> <span style=color:#ae81ff>142253279</span> <span style=color:#ae81ff>137985600</span> <span style=color:#ae81ff>83</span> Linux
</span></span><span style=display:flex><span>image-filep4 <span style=color:#ae81ff>0</span> - <span style=color:#ae81ff>0</span> <span style=color:#ae81ff>0</span> Empty
</span></span></code></pre></div><p>Suppose you want to extract partition number 3. You can see that it starts at
block 4267680 and is 137985600 blocks long. This translates to:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># dd if=image-file of=partition3-file skip=4267680 count=137985600</span>
</span></span></code></pre></div><p>Peeking into the contents of the partition is as easy as:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># mount -t ext3 -o loop partition3-file /mnt/hack</span>
</span></span></code></pre></div><p>Also, you can avoid using dd to extract the partition file by passing the
<code>offset</code> option to mount.</p></div></article><hr><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=tags/linux/>linux</a></span>
<span class=tag><a href=tags/unix/>unix</a></span>
<span class=tag><a href=tags/sysadm/>sysadm</a></span></p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/></svg><span class=tag><a href=categories/system-administration/>system administration</a></span></p></div></main></div><footer class=footer></footer></div><script type=text/javascript src=/bundle.min.0ff8dfb0afbbd356889404268a3c77b2150f8884d958e7c5cff4053d529b718f4563067607fa968fe39ab722dc94c88e0cb8823cc03cac475cb38e26821d03e5.js integrity="sha512-D/jfsK+701aIlAQmijx3shUPiITZWOfFz/QFPVKbcY9FYwZ2B/qWj+OatyLclMiODLiCPMA8rEdcs44mgh0D5Q=="></script></body></html>